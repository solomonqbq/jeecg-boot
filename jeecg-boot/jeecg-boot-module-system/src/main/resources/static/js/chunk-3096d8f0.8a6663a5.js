(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3096d8f0"],{ca7e:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticStyle:{height:"100%"},attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[e.queryInfo&&e.queryInfo.length>0?a("a-row",{attrs:{gutter:24}},[e._l(e.queryInfo,(function(t,r){return["1"===t.hidden?[t.view.indexOf("Date")>=0?a("a-col",{directives:[{name:"show",rawName:"v-show",value:e.toggleSearchStatus,expression:"toggleSearchStatus"}],key:"query"+r,attrs:{md:12,sm:16}},[a("onl-cgreport-query-form-item",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1):a("a-col",{directives:[{name:"show",rawName:"v-show",value:e.toggleSearchStatus,expression:"toggleSearchStatus"}],key:"query"+r,attrs:{md:6,sm:8}},[a("onl-cgreport-query-form-item",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1)]:[t.view.indexOf("Date")>=0?a("a-col",{key:"query"+r,attrs:{md:12,sm:16}},[a("onl-cgreport-query-form-item",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1):a("a-col",{key:"query"+r,attrs:{md:6,sm:8}},[a("onl-cgreport-query-form-item",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1)]]})),a("a-col",{attrs:{md:6,sm:8}},[a("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:e.searchByQuery}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary",icon:"reload"},on:{click:e.searchReset}},[e._v("重置")]),a("a",{staticStyle:{"margin-left":"8px"},on:{click:e.handleToggleSearch}},[e._v("\n              "+e._s(e.toggleSearchStatus?"收起":"展开")+"\n              "),a("a-icon",{attrs:{type:e.toggleSearchStatus?"up":"down"}})],1)],1)])],2):e._e()],1)],1),a("div",{staticClass:"table-operator",staticStyle:{"margin-bottom":"10px"}},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.exportExcel}},[e._v("导出")])],1),a("a-table",{ref:"table",staticStyle:{"min-height":"300px"},attrs:{size:"middle",bordered:"",rowKey:"id",columns:e.table.columns,dataSource:e.table.dataSource,pagination:e.table.pagination,loading:e.table.loading,scroll:e.table.scroll,rowSelection:{fixed:!0,selectedRowKeys:e.table.selectedRowKeys,onChange:e.handleChangeInTableSelect}},on:{change:e.handleChangeInTable},scopedSlots:e._u([e._l(e.fieldHrefSlots,(function(t){return{key:t.slotName,fn:function(r,o){return[a("a",{on:{click:function(a){return e.handleClickFieldHref(t,o)}}},[e._v(e._s(r))])]}}}))],null,!0)}),a("a-modal",e._g(e._b({},"a-modal",e.hrefComponent.model,!1),e.hrefComponent.on),[a(e.hrefComponent.is,e._b({tag:"component"},"component",e.hrefComponent.params,!1))],1)],1)},o=[],n=(a("456d"),a("c5f6"),a("75fc")),s=(a("ac4d"),a("8a81"),a("ac6a"),a("b5ef")),i=a("0fea"),c=a("89f2"),l=a("ca00"),u={name:"OnlCgreportAutoList",mixins:[s["a"]],components:{},data:function(){return{queryInfo:[],queryParamsMap:{},selfParam:{},sorter:{column:"",order:"desc"},dictOptions:{},toggleSearchStatus:!1,reportCode:"",description:"在线报表功能测试页面",url:{getColumnsAndData:"/online/cgreport/api/getColumnsAndData/",getQueryInfo:"/online/cgreport/api/getQueryInfo/",getParamsInfo:"/online/cgreport/api/getParamsInfo/"},table:{loading:!0,columns:[],dataSource:[],selectedRowKeys:[],selectionRows:[],scroll:{x:!1},pagination:{current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:function(e,t){return t[0]+"-"+t[1]+" 共"+e+"条"},showQuickJumper:!0,showSizeChanger:!0,total:0}},cgreportHeadName:""}},mounted:function(){this.initParamsInfo(),this.initQueryInfo()},watch:{$route:function(){this.initParamsInfo(),this.initQueryInfo()}},computed:{queryParam:{get:function(){return this.queryParamsMap[this.reportCode]},set:function(e){this.$set(this.queryParamsMap,this.reportCode,e)}}},methods:{initParamsInfo:function(){var e=this;if(!this.$route.params.code)return!1;this.reportCode=this.$route.params.code,this.queryParam||(this.queryParam={}),this.selfParam={},Object(i["c"])("".concat(this.url.getParamsInfo).concat(this.reportCode)).then((function(t){if(t.success){if(t.result&&t.result.length>0){var a=!0,r=!1,o=void 0;try{for(var n,s=t.result[Symbol.iterator]();!(a=(n=s.next()).done);a=!0){var i=n.value;e.selfParam["self_"+i.paramName]=e.$route.query[i.paramName]?e.$route.query[i.paramName]:""}}catch(c){r=!0,o=c}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}}}else e.$message.warning(t.message);e.loadData()}))},initQueryInfo:function(){var e=this;if(!this.reportCode)return!1;Object(i["c"])("".concat(this.url.getQueryInfo).concat(this.reportCode)).then((function(t){t.success?e.queryInfo=t.result:e.$message.warning(t.message)}))},loadData:function(e){var t=this;if(!this.reportCode)return!1;1==e&&(this.table.pagination.current=1);var a=this.getQueryParams();this.table.loading=!0,Object(i["c"])("".concat(this.url.getColumnsAndData).concat(this.reportCode),a).then((function(e){if(e.success){var a=e.result,r=a.data,o=a.columns,s=a.cgreportHeadName,i=a.dictOptions,l=a.fieldHrefSlots,u=230;t.dictOptions=i;for(var d=0;d<o.length;d++)o[d].customRender&&function(){var e=o[d].customRender;o[d].customRender=function(a){return a?Object(c["b"])(t.dictOptions[e],a+""):a}}(),o.width=u;t.table.scroll.x=o.length*u,t.table.columns=Object(n["a"])(o),t.cgreportHeadName=s,t.fieldHrefSlots=l,r?(t.table.pagination.total=Number(r.total),t.table.dataSource=r.records):(t.table.pagination.total=0,t.table.dataSource=[])}else t.$message.warn("查询失败："+e.message)})).catch((function(e){t.$message.error("查询失败")})).finally((function(){t.table.loading=!1}))},getQueryParams:function(){var e=Object.assign({},this.queryParam,this.sorter,this.selfParam);return e.pageNo=this.table.pagination.current,e.pageSize=this.table.pagination.pageSize,Object(l["d"])(e)},searchByQuery:function(){this.loadData(1)},searchReset:function(){this.queryParam={},this.loadData(1)},handleToggleSearch:function(){this.toggleSearchStatus=!this.toggleSearchStatus},exportExcel:function(){var e=this,t=this.cgreportHeadName,a={};for(var r in this.$route.query)if(this.$route.query.hasOwnProperty(r)){var o=this.$route.query[r];a["self_"+r]=o||""}Object(i["b"])("/online/cgreport/api/exportXls/".concat(this.reportCode),Object.assign(a,this.queryParam)).then((function(a){if(a)if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(new Blob([a]),t+".xls");else{var r=window.URL.createObjectURL(new Blob([a])),o=document.createElement("a");o.style.display="none",o.href=r,o.setAttribute("download",t+".xls"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(r)}else e.$message.warning("文件下载失败")}))},handleChangeInTableSelect:function(e,t){this.table.selectedRowKeys=e,this.table.selectionRows=t},handleChangeInTable:function(e,t,a){Object.keys(a).length>0?(this.sorter.column=a.field,this.sorter.order="ascend"==a.order?"asc":"desc"):(this.sorter.column=null,this.sorter.order=null),this.table.pagination=e,this.loadData()}}},d=u,m=(a("e235"),a("2877")),h=Object(m["a"])(d,r,o,!1,null,"5a4fa1dc",null);t["default"]=h.exports},e235:function(e,t,a){"use strict";var r=a("ecae"),o=a.n(r);o.a},ecae:function(e,t,a){}}]);